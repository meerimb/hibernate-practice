package peaksoft.student;

import org.hibernate.Session;
import org.hibernate.query.Query;
import peaksoft.util.HibernateUtil;

import java.util.List;

/**
 * Hello world!
 *
 */
public class AppStudent {
    public static void main(String[] args) {

//        HibernateUtil.getSessionFactory();

//        Student student = new Student("Gustav", "Art", 45, "Austria");
//        create(student);
//        System.out.println(getById(6));
        read();
//        update(1,"Klimt",46);
//        delete(1);
//        deleteAll();

    }

    public static int create(Student student) {
        Session session = HibernateUtil.getSessionFactory().openSession();
        session.beginTransaction();
        session.save(student);
        session.getTransaction().commit();
        session.close();
        System.out.println("Student successfully added :" + student);
        return student.getId();
    }

    public static Student getById(int id) {
        Session session = HibernateUtil.getSessionFactory().openSession();
        session.beginTransaction();
        Student student = session.get(Student.class, id);
        session.getTransaction().commit();
        session.close();
        return student;
    }

    public static List<Student>read(){
        Session session=HibernateUtil.getSessionFactory().openSession();
        session.beginTransaction();
        List<Student>students=session.createQuery("From Student").getResultList();
        session.getTransaction().commit();
        session.close();
        System.out.println("Finded "+students.size()+"students");
        return students;
    }

    public static void update(int id,String name,int age){
        Session session=HibernateUtil.getSessionFactory().openSession();
        session.beginTransaction();
        Student student=session.get(Student.class,id);
        student.setName(name);
        student.setAge(age);
        session.getTransaction().commit();
        session.close();
        System.out.println("Successfully updated");
    }

    public static void delete(int id){
        Session session=HibernateUtil.getSessionFactory().openSession();
        session.beginTransaction();
        Student student=session.get(Student.class,id);
        session.delete(student);
        session.getTransaction().commit();
        session.close();
        System.out.println("Successfully deleted"+student);
    }

    public static void deleteAll(){
        Session session=HibernateUtil.getSessionFactory().openSession();
        session.beginTransaction();
        Query query=session.createQuery("delete from Student");query.executeUpdate();
        session.getTransaction().commit();
        System.out.println("Successfully deleted all datas in students");
    }
}



























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































